import requests
import json

def receive_northflank_payload(url, headers):
    """
    Northflankからペイロードを受信する関数

    Args:
        url (str): NorthflankのAPIエンドポイント
        headers (dict): リクエストヘッダー (e.g., {'Authorization': 'Bearer your_api_key'})

    Returns:
        dict: 受信したペイロード (JSON形式)
    """

    try:
        response = requests.get(url, headers=headers)
        response.raise_for_status()  # ステータスコードが異常な場合、例外を発生させる

        payload = response.json()
        return payload

    except requests.exceptions.RequestException as e:
        print(f"Error fetching payload: {e}")
        return None

# 実行例
url = "https://your-northflank-endpoint"
headers = {'Authorization': 'Bearer your_api_key'}

payload = receive_northflank_payload(url, headers)

if payload:
    print(json.dumps(payload, indent=2))
    # ここで、受信したペイロードを処理する (e.g., データベースに保存)
